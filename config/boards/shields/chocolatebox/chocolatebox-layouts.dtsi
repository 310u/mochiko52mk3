#include "./position_map.dtsi"
#include <physical_layouts.dtsi>

/ {
  chocolatebox_physical_layout: chocolatebox_physical_layout {
    compatible = "zmk,physical-layout";
    display-name = "Chocolatebox";
    transform = <&default_transform>;
    kscan = <&kscan0>;

    /* ---- 非回転エリア（上段の 1,2 と 右端の - =、左右の縦列など） ---- */
    keys =
      /* 上段 左端 */
      <&key_physical_attrs 100 100   75   0   0   0    0>,  /* 0: "1"  (x=0.75u) */
      <&key_physical_attrs 100 100  175   0   0   0    0>,  /* 1: "2"  */
      /* 上段 右端（x:9u 分のギャップ後に -,=） */
      <&key_physical_attrs 100 100 1000   0   0   0    0>,  /* 10: "-" */
      <&key_physical_attrs 100 100 1100   0   0   0    0>,  /* 11: "=" */

      /* 左縦列 Q / A / SHIFT / CTRL（x=150,y=100間隔の例） */
      <&key_physical_attrs 150 100    0 100  0  0 0>,      /* Q が1.5u */
      <&key_physical_attrs 175 100    0 200  0  0 0>,      /* A が1.75u */
      <&key_physical_attrs 125 100    0 300  0  0 0>,      /* SHIFT 1.25u */
      <&key_physical_attrs 125 100   75 400  0  0 0>,      /* CTRL 1.25u (x=0.75u) */

      /* 右縦列群（P / ; / Enter, SHIFT, CTRL）は適宜 例: */
      <&key_physical_attrs 100 100  900 100  0 0 0>,       /* P */
      <&key_physical_attrs 100 100  925 200  0 0 0>,       /* ; (x=+0.25u) */
      /* Enter は 1.25u幅×2u高：w=125,h=200, 2行占有するなら y は同じでOK */
      <&key_physical_attrs 125 200  925 100  0 0 0>,       /* ENTER */
      <&key_physical_attrs 225 100  925 300  0 0 0>,       /* SHIFT 2.25u */
      <&key_physical_attrs 125 100  950 400  0 0 0>,       /* CTRL 1.25u */

      /* ---- 左 10° ブロック（回転中の支点を固定）---- */
      /* 支点：rx=20u, ry=3u → 2000, 300 */
      <&key_physical_attrs 100 100  -1675  300  10  2000 300>, /* "3"  x=-16.75u, y=3u */
      <&key_physical_attrs 100 100  -1575  300  10  2000 300>, /* "4" */
      <&key_physical_attrs 100 100  -1475  300  10  2000 300>, /* "5" */
      <&key_physical_attrs 100 100  -1375  300  10  2000 300>, /* "6" */

      <&key_physical_attrs 100 100  -1675  400  10  2000 300>, /* "W" */
      <&key_physical_attrs 100 100  -1575  400  10  2000 300>, /* "E" */
      <&key_physical_attrs 100 100  -1475  400  10  2000 300>, /* "R" */
      <&key_physical_attrs 100 100  -1375  400  10  2000 300>, /* "T" */

      <&key_physical_attrs 100 100  -1675  500  10  2000 300>, /* "S" */
      <&key_physical_attrs 100 100  -1575  500  10  2000 300>, /* "D" */
      <&key_physical_attrs 100 100  -1475  500  10  2000 300>, /* "F" */
      <&key_physical_attrs 100 100  -1375  500  10  2000 300>, /* "G" */

      <&key_physical_attrs 100 100  -1675  600  10  2000 300>, /* "X" */
      <&key_physical_attrs 100 100  -1575  600  10  2000 300>, /* "C" */
      <&key_physical_attrs 100 100  -1475  600  10  2000 300>, /* "V" */
      <&key_physical_attrs 100 100  -1375  600  10  2000 300>, /* "B" */

      <&key_physical_attrs 125 100  -1675  700  10  2000 300>, /* "ALT" 1.25u */
      <&key_physical_attrs 225 100  -1550  700  10  2000 300>, /* "SPACE" 2.25u */
      <&key_physical_attrs 100 100  -1325  700  10  2000 300>, /* "Fn" */

      /* ---- 右 -10° ブロック（支点 rx=11.75u → 1175, ry=0）---- */
      <&key_physical_attrs 100 100  -425   300  -10  1175 0>,  /* "7"  (x:-4.25u, y:3u と同様の置き方に合わせる) */
      <&key_physical_attrs 100 100  -325   300  -10  1175 0>,  /* "8" */
      <&key_physical_attrs 100 100  -225   300  -10  1175 0>,  /* "9" */
      <&key_physical_attrs 100 100  -125   300  -10  1175 0>,  /* "0" */

      <&key_physical_attrs 100 100  -425   400  -10  1175 0>,  /* "Y" */
      <&key_physical_attrs 100 100  -325   400  -10  1175 0>,  /* "U" */
      <&key_physical_attrs 100 100  -225   400  -10  1175 0>,  /* "I" */
      <&key_physical_attrs 100 100  -125   400  -10  1175 0>,  /* "O" */

      <&key_physical_attrs 100 100  -425   500  -10  1175 0>,  /* "H" */
      <&key_physical_attrs 100 100  -325   500  -10  1175 0>,  /* "J" */
      <&key_physical_attrs 100 100  -225   500  -10  1175 0>,  /* "K" */
      <&key_physical_attrs 100 100  -125   500  -10  1175 0>,  /* "L" */

      <&key_physical_attrs 100 100  -500   600  -10  1175 0>,  /* "N" (x:-4.75u の例) */
      <&key_physical_attrs 100 100  -400   600  -10  1175 0>,  /* "M" */
      <&key_physical_attrs 100 100  -300   600  -10  1175 0>,  /* "," */
      <&key_physical_attrs 100 100  -200   600  -10  1175 0>,  /* "." */

      <&key_physical_attrs 100 100  -475   700  -10  1175 0>,  /* "Fn" */
      <&key_physical_attrs 225 100  -350   700  -10  1175 0>,  /* "BSPC" 2.25u */
      <&key_physical_attrs 125 100  -125   700  -10  1175 0>   /* "ALT" 1.25u */
      ;
  };
};


&layouts_chocolatebox_position_map {
    layout_chocolatebox_map: layout_mable {
        physical-layout = <&chocolatebox_physical_layout>;
        positions
            = < 0  1  2  3  4  5    6  7  8  9 10 11>
            , <   11 12 13 14 15   16 17 18 19 20 21>
            , <   22 23 24 25 26   27 28 29 30 31>
            , <33 34 35 36 37 38   39 40 41 42 43>
            , <   44 45    46 47   48 49    50 51>

            ;
    };
};