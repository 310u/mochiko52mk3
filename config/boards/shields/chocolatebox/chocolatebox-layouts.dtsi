#include "./position_map.dtsi"
#include <physical_layouts.dtsi>

/ {
    chocolatebox_physical_layout: chocolatebox_physical_layout {
        compatible = "zmk,physical-layout";
        display-name = "Chocolatebox";
        transform = <&default_transform>;
        kscan = <&kscan0>;
               keys  //                                w    h     x     y    rot    rx    ry
            /* Row0: RC(0,0..11) → 1 2 3 4 5 6 | 7 8 9 0 - = */
            = <&key_physical_attrs              100  100    75     0      0    300     0>  /* C0  1  小指=水平 */
            , <&key_physical_attrs              100  100   175     0      0    300     0>  /* C1  2  小指=水平 */
            , <&key_physical_attrs              100  100   250     0   1000    325     0>  /* C2  3  ← ROW0: 基準より左へ0.25u */
            , <&key_physical_attrs              100  100   350     0   1000    325     0>  /* C3  4  */
            , <&key_physical_attrs              100  100   450     0   1000    325     0>  /* C4  5  */
            , <&key_physical_attrs              100  100   550     0   1000    325     0>  /* C5  6  */
            , <&key_physical_attrs              100  100   900     0  (-1000)  1250    0>  /* C6  7  右手−10° */
            , <&key_physical_attrs              100  100  1000     0  (-1000)  1250    0>  /* C7  8  */
            , <&key_physical_attrs              100  100  1100     0  (-1000)  1250    0>  /* C8  9  */
            , <&key_physical_attrs              100  100  1200     0  (-1000)  1250    0>  /* C9  0  */
            , <&key_physical_attrs              100  100  1300     0      0    1300    0>  /* C10 - 小指=水平 */
            , <&key_physical_attrs              100  100  1400     0      0    1400    0>  /* C11 = 小指=水平 */

            /* Row1: RC(1,1..11) → q w e r t | y u i o p Enter(ISO) */
            , <&key_physical_attrs              150  100   100   110      0    300     0>  /* C1  q 小指=水平（基準段） */
            , <&key_physical_attrs              100  100   275   110   1000    350     0>  /* C2  w  ← 基準 */
            , <&key_physical_attrs              100  100   375   110   1000    350     0>  /* C3  e  */
            , <&key_physical_attrs              100  100   475   110   1000    350     0>  /* C4  r  */
            , <&key_physical_attrs              100  100   575   110   1000    350     0>  /* C5  t  */
            , <&key_physical_attrs              100  100   925   110  (-1000)  1225   110> /* C6  y  */
            , <&key_physical_attrs              100  100  1025   110  (-1000)  1225   110> /* C7  u  */
            , <&key_physical_attrs              100  100  1125   110  (-1000)  1225   110> /* C8  i  */
            , <&key_physical_attrs              100  100  1225   110  (-1000)  1225   110> /* C9  o  */
            , <&key_physical_attrs              100  100  1325   110      0    1300   110> /* C10 p 小指=水平 */
            , <&key_physical_attrs              125  200  1475   110      0    1500   210> /* C11 Enter ISO（水平） */

            /* Row2: RC(2,1..10) → a s d f g | h j k l ; */
            , <&key_physical_attrs              175  100    50   220      0    300     0>  /* C1  a 小指=水平 */
            , <&key_physical_attrs              100  100   300   220   1000    375     0>  /* C2  s  ← ROW2: 基準より右へ0.25u */
            , <&key_physical_attrs              100  100   400   220   1000    375     0>  /* C3  d  */
            , <&key_physical_attrs              100  100   500   220   1000    375     0>  /* C4  f  */
            , <&key_physical_attrs              100  100   600   220   1000    375     0>  /* C5  g  */
            , <&key_physical_attrs              100  100   950   220  (-1000)  1225   220> /* C6  h  */
            , <&key_physical_attrs              100  100  1050   220  (-1000)  1225   220> /* C7  j  */
            , <&key_physical_attrs              100  100  1150   220  (-1000)  1225   220> /* C8  k  */
            , <&key_physical_attrs              100  100  1250   220  (-1000)  1225   220> /* C9  l  */
            , <&key_physical_attrs              100  100  1350   220      0    1500   220> /* C10 ; 小指=水平 */

            /* Row3: RC(3,0..10) → Shift z x c v b | n m , . RShift */
            , <&key_physical_attrs              125  100     0   330      0    300     0>  /* C0  LShift 小指=水平 */
            , <&key_physical_attrs              100  100   125   330      0    300     0>  /* C1  z 小指=水平 */
            , <&key_physical_attrs              100  100   325   330   1000    400     0>  /* C2  x  ← ROW3: 基準より右へ0.5u */
            , <&key_physical_attrs              100  100   425   330   1000    400     0>  /* C3  c  */
            , <&key_physical_attrs              100  100   525   330   1000    400     0>  /* C4  v  */
            , <&key_physical_attrs              100  100   625   330   1000    400     0>  /* C5  b  */
            , <&key_physical_attrs              100  100   975   330  (-1000)  1225   330> /* C6  n  */
            , <&key_physical_attrs              100  100  1075   330  (-1000)  1225   330> /* C7  m  */
            , <&key_physical_attrs              100  100  1175   330  (-1000)  1225   330> /* C8  ,  */
            , <&key_physical_attrs              100  100  1275   330  (-1000)  1225   330> /* C9  .  */
            , <&key_physical_attrs              225  100  1375   330      0    1400   330> /* C10 RShift 小指=水平 */

            /* Row4: RC(4,1,2,4,5,6,7,9,10) → GUI ALT SPACE Fn | Fn BSPC ALT CTRL */
            , <&key_physical_attrs              125  100    75   440      0    300     0>  /* C1  GUI 小指=水平 */
            , <&key_physical_attrs              125  100   350   440   1000    475     0>  /* C2  LAlt ← 基準より右へ0.75u */
            , <&key_physical_attrs              225  100   550   440   1000    550     0>  /* C4  Space */
            , <&key_physical_attrs              100  100   650   440   1000    425     0>  /* C5  Fn   */
            , <&key_physical_attrs              100  100   950   440  (-1000)  1225   440> /* C6  Fn   */
            , <&key_physical_attrs              225  100  1050   440  (-1000)  1225   440> /* C7  Bspc */
            , <&key_physical_attrs              125  100  1275   440  (-1000)  1225   440> /* C9  RAlt */
            , <&key_physical_attrs              125  100  1400   440      0    1425   440> /* C10 RCtrl 小指=水平 */
        ;
    };
};

&layouts_chocolatebox_position_map {
    layout_chocolatebox_map: layout_mable {
        physical-layout = <&chocolatebox_physical_layout>;
        positions
            = < 0  1  2  3  4  5    6  7  8  9 10 11>
            , <   11 12 13 14 15   16 17 18 19 20 21>
            , <   22 23 24 25 26   27 28 29 30 31>
            , <33 34 35 36 37 38   39 40 41 42 43>
            , <   44 45    46 47   48 49    50 51>

            ;
    };
};  