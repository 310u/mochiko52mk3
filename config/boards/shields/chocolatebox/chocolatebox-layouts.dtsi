#include "./position_map.dtsi"
#include <physical_layouts.dtsi>

/ {
    chocolatebox_physical_layout: chocolatebox_physical_layout {
        compatible = "zmk,physical-layout";
        display-name = "Chocolatebox";
        transform = <&default_transform>;
        kscan = <&kscan0>;
                      keys  //                     w    h     x     y   rot  rx  ry
            /* ───────── 左手ブロック ───────── */
            /* Row0 */
            = <&key_physical_attrs 100 100     0     0     0   300   0>  /* 小指列: 1 → 水平 */
            , <&key_physical_attrs 100 100   100     0    10   300   0>
            , <&key_physical_attrs 100 100   200     0    10   300   0>
            , <&key_physical_attrs 100 100   300     0    10   300   0>
            , <&key_physical_attrs 100 100   400     0    10   300   0>
            /* Row1 */
            , <&key_physical_attrs 150 100     0   100    10   300   0>  /* Q 1.5u（ここは水平にしない） */
            , <&key_physical_attrs 100 100   150   100    10   300   0>
            , <&key_physical_attrs 100 100   250   100    10   300   0>
            , <&key_physical_attrs 100 100   350   100    10   300   0>
            , <&key_physical_attrs 100 100   450   100    10   300   0>
            /* Row2 */
            , <&key_physical_attrs 100 100     0   200     0   300   0>  /* 小指列: Ctrl → 水平 */
            , <&key_physical_attrs 100 100   100   200    10   300   0>
            , <&key_physical_attrs 100 100   200   200    10   300   0>
            , <&key_physical_attrs 100 100   300   200    10   300   0>
            , <&key_physical_attrs 100 100   400   200    10   300   0>
            /* Row3 */
            , <&key_physical_attrs 125 100     0   300     0   300   0>  /* 小指列: LShift 1.25u → 水平 */
            , <&key_physical_attrs 100 100   150   300    10   300   0>
            , <&key_physical_attrs 100 100   250   300    10   300   0>
            , <&key_physical_attrs 100 100   350   300    10   300   0>
            , <&key_physical_attrs 100 100   450   300    10   300   0>
            /* Row4（親指段） */
            , <&key_physical_attrs 100 100     0   400     0   300   0>  /* 小指側: GUI → 水平 */
            , <&key_physical_attrs 125 100   100   400    10   300   0>  /* LAlt 1.25u */
            , <&key_physical_attrs 225 100   250   400    10   300   0>  /* Space 2.25u */
            , <&key_physical_attrs 100 100   500   400    10   300   0>  /* Fn */

            /* ───────── 右手ブロック ───────── */
            /* Row0 */
            , <&key_physical_attrs 100 100   800     0   350   900   0>
            , <&key_physical_attrs 100 100   900     0   350   900   0>
            , <&key_physical_attrs 100 100  1000     0   350   900   0>
            , <&key_physical_attrs 100 100  1100     0   350   900   0>
            , <&key_physical_attrs 100 100  1200     0     0   900   0>  /* 小指列: '-' or '=' → 水平 */
            /* Row1（＋縦2u Enter） */
            , <&key_physical_attrs 100 100   800   100   350   900   0>
            , <&key_physical_attrs 100 100   900   100   350   900   0>
            , <&key_physical_attrs 100 100  1000   100   350   900   0>
            , <&key_physical_attrs 100 100  1100   100   350   900   0>
            , <&key_physical_attrs 100 100  1200   100     0   900   0>  /* 小指列: 'P' 側 → 水平 */
            , <&key_physical_attrs 100 200  1300   100     0   900   0>  /* Enter 縦2u → 水平のまま */
            /* Row2 */
            , <&key_physical_attrs 100 100   800   200   350   900   0>
            , <&key_physical_attrs 100 100   900   200   350   900   0>
            , <&key_physical_attrs 100 100  1000   200   350   900   0>
            , <&key_physical_attrs 100 100  1100   200     0   900   0>  /* 小指列: ';' → 水平 */
            , <&key_physical_attrs 100 100  1200   200     0   900   0>  /* 外周列も水平でOK */
            /* Row3 */
            , <&key_physical_attrs 100 100   800   300   350   900   0>
            , <&key_physical_attrs 100 100   900   300   350   900   0>
            , <&key_physical_attrs 100 100  1000   300   350   900   0>
            , <&key_physical_attrs 100 100  1100   300     0   900   0>  /* 小指列: '.' → 水平 */
            , <&key_physical_attrs 225 100   975   400     0   900   0>  /* RShift 2.25u → 小指なので水平 */
            /* Row4（親指段） */
            , <&key_physical_attrs 100 100   800   400   350   900   0>  /* 例: BkSp */
            , <&key_physical_attrs 125 100   900   400   350   900   0>  /* RAlt 1.25u */
            , <&key_physical_attrs 100 100  1000   400   350   900   0>  /* RCtrl */
            , <&key_physical_attrs 100 100  1100   400     0   900   0>  /* 小指側: '^' 等 → 水平 */
        ;

    };
};

&layouts_chocolatebox_position_map {
    layout_chocolatebox_map: layout_mable {
        physical-layout = <&chocolatebox_physical_layout>;
        positions
            = < 0  1  2  3  4  5    6  7  8  9 10 11>
            , <   11 12 13 14 15   16 17 18 19 20 21>
            , <   22 23 24 25 26   27 28 29 30 31>
            , <33 34 35 36 37 38   39 40 41 42 43>
            , <   44 45    46 47   48 49    50 51>

            ;
    };
};