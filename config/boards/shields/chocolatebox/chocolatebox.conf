# ZMK 基本設定
CONFIG_ZMK_SLEEP=y
CONFIG_ZMK_IDLE_SLEEP_TIMEOUT=3600000

# ポインティングデバイス設定
CONFIG_ZMK_POINTING=y
CONFIG_ZMK_MOUSE=y
# マウスのポーリングレート（必要に応じて30などに変更）
CONFIG_ZMK_MOUSE_POLL_MS=20

# ハードウェア関連
CONFIG_SPI=y

# ドライバー
CONFIG_PMW3610=y

# 機能設定
CONFIG_NFCT_PINS_AS_GPIOS=y
CONFIG_PMW3610_SWAP_XY=y
# CONFIG_PMW3610_INVERT_X=y
# CONFIG_PMW3610_INVERT_Y=y
CONFIG_ZMK_STUDIO=y
CONFIG_ZMK_STUDIO_LOCKING=n
CONFIG_USB_HID_POLL_INTERVAL_MS=1

# -----------------------------
# BT設定（基本＋ラグ対策）
# -----------------------------
# 基本的なBluetooth機能を有効化
CONFIG_BT=y
CONFIG_BT_PERIPHERAL=y
CONFIG_BT_CTLR_TX_PWR_PLUS_8=y
CONFIG_ZMK_BATTERY_REPORTING=y

# 互換性のため2M PHYは無効化を推奨
CONFIG_BT_CTLR_PHY_2M=n

# スタックサイズ設定
# 分割キーボードでなければ不要ですが、念のため残します
CONFIG_ZMK_BLE_THREAD_STACK_SIZE=2048
CONFIG_ZMK_LOW_PRIORITY_THREAD_STACK_SIZE=2048
CONFIG_ZMK_SPLIT_BLE_PERIPHERAL_STACK_SIZE=2048
CONFIG_ZMK_SPLIT_BLE_CENTRAL_SPLIT_RUN_STACK_SIZE=3096
CONFIG_INPUT_THREAD_STACK_SIZE=2048

# --- ラグ対策設定 ---

# 接続間隔の最適化 (7.5ms - 15ms)
CONFIG_BT_PERIPHERAL_PREF_MIN_CONN_INTERVAL=6
CONFIG_BT_PERIPHERAL_PREF_MAX_CONN_INTERVAL=12

# MTUサイズを大きくして転送効率を上げる
CONFIG_BT_L2CAP_TX_MTU=247
CONFIG_BT_BUF_ACL_TX_SIZE=251

# 接続イベント長の最適化
CONFIG_BT_CTLR_SCHED_ADVANCED=y
CONFIG_BT_CONN_EVENT_LEN_MAX_CE_LEN=6

# 実験的機能はWindowsとの相性問題が出やすいため無効化
# CONFIG_ZMK_BLE_EXPERIMENTAL_CONN=y